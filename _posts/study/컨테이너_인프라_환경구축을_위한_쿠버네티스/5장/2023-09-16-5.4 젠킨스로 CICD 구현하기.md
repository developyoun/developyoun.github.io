---
title: 5.4 젠킨스로 CI/CD 구현하기

categories:
- 쿠버네티스/도커

tags:
- kubenetes
- docker

toc: true
toc_sticky: true
toc_label: Contents
---

> 젠킨스의 **아이템** 이란, 새롭게 정의할 작업을 의미한다.

젠킨스에서 모든 작업의 정의와 순서를 모아 둔 전체 작업을 **프로젝트** 라고 하는데, 프로젝트를 구성하는 방법은 여러가지가 있다.

또한, 이렇게 프로젝트를 정의하고 생성하는 것을 아이템이라고 하며, 프로젝트 외에 실제로 작업에 도움이 되는 내용들을 정의하는 것도 아이템을 생성한다고 할 수 있다.

**프로젝트를 구성하는 방법**

1. Freestyle project
    * 스타일의 자유도가 높은 방식
    * 브라우저에서 사용자가 직접 설정값과 수행할 동작을 입력할 수 있다.
    * 화면에 보이는 항목을 입력하면서 경험이 부족한 사용자도 구성하기 쉬운 장점이 있다.
    * 그러나 과정이 복잡한 작업을 하기에 제한이 있다.
    * 또한, 이를 이용해 생성한 아이템은 입력한 항목의 명세서를 별도로 저장하는 과정이 없어 공유하기 어렵다.
2. Pipeline
    * 젠킨스에서 지원하는 고유의 Pipeline 문법으로 코드를 작성해 작업을 정의하는 프로젝트
    * 법을 사전에 숙지해야 한다는 점 때문에 비교적 진입 장벽이 있다.
    * 그러나 프로그래밍 기법을 사용할 수 있어 복잡한 방식의 작업을 정의하는 것이 가능하다.
    * 작성한 코드를 통해 새로운 프로젝트를 생성하는거나 수정해 재사용하기도 수월하다.
    * 어플리케이션 코드와 방법을 함께 관리할 수 있기 때문에 관리 편의성도 높다.
3. Multi-configuration project
    * 하나의 소스 코드를 여러 조건의 조합으로 나온 경우의 수에 해당하는 환경에 동시에 배포하는 프로젝트
4. Folder
    * 젠킨스의 작업이 늘어나면서 생기는 관리 어려움을 해결할 수 있는 방법
    * 분류 가능한 디렉토리를 생성하여 관리 한다.
5. Multibranch Pipeline
    * 하나의 소스 코드 저장소 내에 존재하는 각 브랜치에서 젠킨스 파이프라인 코드가 작성된 파일을 불러와 한번에 여러 브랜치에 대해 작업을 가능하게 한다.

**Pipeline 프로젝트로 구현하는 블루그린 배포 전략**

> 쿠버네티스에서 어플리케이션을 배포하는 것은 어렵지 않으나, 파드의 특성상 배포되는 어플리케이션의 변경이 있다면 언제나 삭제하고 다시 생성하는 과정을 거친다.
>
> 즉, 중요한 서비스가 동작하고 있을 경우 중단되는 시간이 발생하는 것은 큰 부담일 수 있다.
>
> 이에 문제의 해결방법 중 하나로, 중단 없이 배포하는 방법인 블루그린 방법이 있다.

블루그린 배포 전략은 **모든 파드가 업데이트된 이후에 트래픽을 전달하자** 로 설명할 수 있다.

1. 2개의 디플로이먼트를 생성
2. 기존에 배포된 디플로이먼트(블루)로 계속 트래픽을 전달
3. 새로 배포되는 디플로이먼트(그린)에 모든 파드가 업데이트
4. 트래픽을 처리하는 데 문제가 없을 때, 서비스(트래픽)를 모두 새로 배포된 디플로이먼트(그린)으로 넘김
5. 기존의 디플로이먼트(블루) 삭제

위의 방법으로 **중단 없이 연속적으로 배포가 가능** 하며, 문제가 발생한 경우 기존에 **서비스하던 디플로이먼트(블루)로 원복하는 것도 수월** 하다.

그러나, 디플로이먼트를 추가적으로 생성해야 한다는 점에서 최소 2배 이상의 리소스를 더 필요로 하게 된다.

> 쿠버네티스 환경에서 블루그린 배포는 기본 기능이 아니기 때문에 구성할 수 없지만, 젠킨스를 이용해 구현이 가능하다.