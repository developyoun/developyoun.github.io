---
title: 5.1 컨테이너 인프라 환경에서 CI/CD

categories:
- 쿠버네티스/도커

tags:
- kubenetes
- docker

toc: true
toc_sticky: true
toc_label: Contents
---

> 일반적으로 CI는 코드를 커밋하고 빌드했을 때, 정상적으로 작동하는지 반복적으로 검증해 어플리케이션의 신뢰성을 높이는 작업이다. CI 과정을 마친 어플리케이션은 신뢰할 수 있는 상태가 되며, CD는 CI 과정을 거친 어플리케이션을 실제 상용 환경에 자동으로 배포하는 것을 의미한다.

#### 5.1.1 CI/CD 도구 비교

* 팀시티(Teamcity)
    * 젯브레인즈에서 만든 CI/CD 도구.
    * 코틀린을 기반으로 반든 Kotlin DSL 이라는 스크립트 언어로 작업을 구성할 수 있다.
    * 빌드를 수행하는 3개의 에이전트와 빌드 작업 100개를 무료로 사용할 수 있지만, 초과시에는 유료 결제를 해야한다.
* 깃허브 액션(Github Action)
    * 깃허브에서 지원하는 워크플로 기반의 CI/CD 도구.
    * 깃허브에 저장한 소스 코드를 자동 분석한 결과를 기반으로 깃허브 액션이 추천하는 방식에 따라 워크플로를 구성할 수 있다.
        * 그 외에도, 사용자가 직접 워크플로를 정의하는 파일을 작성한 후, 깃허브 저장소에 넣어 사용 가능.
    * 깃허브 저장소에 소스 코드를 공개할 경우 깃허브 액션을 무료로 사용할 수 있으나 한 달에 2000분이라는 제한이 있다. 추가시 분 단위의 요금이 부과된다.
* 뱀부(Bamboo)
    * 아틀라시안에서 만든 CI/CD 도구.
    * 유료이며 사용자의 서버에 설치해 사용한다.
    * 아틀라시안에서 만든 다른 협업 도구를 사용 중이라면, 연계하여 사용하기 좋다.
* 젠킨스(Jenkins)
    * 오픈 소스 CI/CD 도구.
    * 사용자가 직접 UI에서 작업을 구성하거나 작업 순서를 코드로 정의할 수 있다.
    * 역사, 인지도, 사용자 수가 월등하여 사용하는데 무리없을 정도로 널리 알려져 있다.
    * 또한, 사용하는데 필요한 정보를 찾기 쉽고 활용 방법과 플러그인 개발 관련 커뮤니티 활동이 활발해, 연계할 플러그인을 쉽게 찾을 수 있다.
    * 특정 언어나 환경에 구애받지 않고 범용적인 목적으로 무난하게 사용가능하다.

| 구분    | 팀시티   | 깃허브 액션 | 뱀부    | 젠킨스    |
| ----- | ----- | ------ | ----- | ------ |
| 설치 방식 | 직접 설치 | 깃허브 연동 | 직접 설치 | 직접 설치  |
| 연계 기능 | 보톤    | 보통     | 부족    | 매우 많음  |
| 가격    | 무료/유료 | 무료/유료  | 유료    | 무료     |
| 기능 추가 | 보통    | 매우 다양함 | 보통    | 매우 다양함 |
| 범용성   | 보통    | 매우 큼   | 보통    | 매우 큼   |
| 정보량   | 부족함   | 많음     | 많음    | 매우 많음  |

그 외에도, 클라우드 기반의 시스템에서는 클라우드 서비스 제공 업체에서 배포하는 CI/CD 도구를, 배포가 중요한 환경에서는 CD 기능에 중정을 준 스핀네이커나 아르고를 선택적으로 사용할 수 있다.

#### 5.1.2 젠킨스로 쿠버네티스 운영 환경 개선하기

> 어플리케이션 배포 영역에 쿠버네티스를 사용하면 개발자는 어플리케이션 개발에만 집중할 수 있다.
>
> 즉, 모든 배포 환경을 컨테이너 인프라로 일원화하고, CI/CD 도구를 사용하면서 어플리케이션에 맞는 환경을 적용해 자동으로 배포할 수 있다. 또한 통합 과정에서 만들어진 컨테이너 이미지를 기반으로 쿠버네티스가 존재하는 어떤 환경에서도 일관성있는 어플리케이션을 배포 할 수 있다.

* 개발자가 작성한 어플리케이션 코드를 소스 코드 저장소에 푸시 →
* 쿠버네티스 내부에 설치된 젠킨스는 어플리케이션 코드를 빌드하고 레지스트리에 푸시 →
* 젠킨스가 쿠버네티스에서 사용 가능한 형태로 배포

컨테이너 인프라 환경에서 젠킨스를 사용하는 주된 이유는, 어플리케이션을 컨테이너로 만들고 배포하는 과정을 **자동화** 하기 위해서 이다.

그러나, 자동화 환경을 단순히 젠킨스용 파드만을 배포해서 만들어 지지는 않으며, 배포에 필요한 설정을 넣는 과정을 하나하나 구성하는 것은 복잡하고 번거로워 효율적이지 않다. (즉, 구성 환경에 따라 많은 부분을 동적으로 변경해야 하는 경우가 생긴다)

이러한 동적 변경 사항을 간편하고 빠르게 적용할 수 있는 도구가 있는데, 하나는 **커스터마이즈(Kustomize)** 이고, 다른 하나는 **헬름(Helm)** 이다.