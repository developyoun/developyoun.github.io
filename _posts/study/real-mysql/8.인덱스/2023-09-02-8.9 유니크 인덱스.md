---
title: 8.9 유니크 인덱스

categories:
- real-mysql

tags:
- study
- database

toc: true
toc_sticky: true
toc_label: Contents
---

유니크 인덱스는 테이블이나 인덱스에 같은 값이 2개 이상 저장될 수 없다는 것을 의미하는데, MySQL에서는 인덱스 없이 유니크 제약만 설정할 방법이 없다.
> 유니크 인덱스에서는 NULL값도 저장될 수 있는데, NULL은 특정값이 아니므로 2개 이상 저장할 수 있다.

## 8.9.1 유니크 인덱스와 일반 세커더리 인덱스의 비교
유니크 인덱스와 유니크하지 않은 일반 세컨더리 인덱스는 사실 인덱스의 구조상 아무런 차이점이 없다.

### 8.9.1.1 인덱스 읽기
유니크 인덱스와 유니크하지 않은 인덱스의 성능의 차이는 거의 없다
→ 세컨더리 인덱스는 중복된 값이 많아서 느릴 뿐, 읽어야 할 레코드 건수가 같다면 성능상의 차이는 미미하다.

### 8.9.1.2 인덱스 쓰기
유니크 인덱스의 키 값을 쓸 때는 중복된 값이 있는지 없는지 체크하는 과정이 한 단계 더 필요하다.
→ 그래서 유니크하지 않은 세컨더리 인덱스의 쓰기보다 느리다.

## 8.9.2 유니크 인덱스 사용 시 주의사항
꼭 필요한 경우라면 유니크 인덱스를 생성하는 것이 당연하지만, 성능이 더 좋아질 것으로 생각하고 불필요하게 유니크 인덱스를 생성하는 것은 좋지 않다.
→ 유니크 인덱스도 일반 세컨더리 인덱스와 같은 역할을 동일하게 수행할 수 있으므로 세컨더리 인덱스를 중복으로 생성할 필요는 없다.
가끔, 똑같은 컬럼에 대해 프라이머리 키와 유니크 인덱스를 동일하게 생성한 경우도 있는데, 이또한 불필요한 중복이다.
**유일성이 꼭 보장되어야 하는 컬럼에 대해서는 유니크 인덱스를 생성하되, 꼭 필요하지 않다면 유니크 인덱스보다는 유니크하지 않은 세컨더리 인덱스를 생성하는 방법도 고려하자**

# 8.10 외래키
MySQL에서 외래키는 InnoDB 스토리지 엔진에서만 생성할 수 있으며, 외래키 제약이 설정되면 자동으로 연관되는 테이블의 컬럼에 인덱스까지 생성된다.
→ 외래키가 제거되지 않은 상태에서는 자동으로 생성된 인덱스를 삭제할 수 없다.

InnoDB의 외래키 관리에는 두 가지 특징이 있다.
- 테이블의 변경이 발생하는 경우에만 잠금 경합(잠금 대기)이 발생한다.
- 외래키와 연관되지 않은 컬럼의 변경은 최대한 잠금 경함(잠금 대기)을 발생시키지 않는다.
**데이터베이스에서 외래 키를 물리적으로 생성하려면 잠금 경합까지 고려해 모델링을 진행하는 것이 좋다.**
